"use strict";function mainCtrl(a,b,c,d,e){function f(){console.log(a.queue.length),0==a.queue.length&&g(),h()}function g(){console.log("create new game...");var b={},c=[],d=3;for(row=0;d>row;++row){var e=[];for(c.push(e),col=0;d>col;++col)e.push({value:"",img:"1x1.png"})}b.ticTacToe=c,b.playerOne={name:""},b.playerTwo={name:""},b.activePlayer="",b.win=!1,b.tie=!1,b.turnCounter=0,b.ready=!1,b.online=!0,b.reset=!1;var f=m.push(b).toString();a.queue.push({gameUrl:f,joined:0})}function h(){console.log("join game....");var b=a.queue[0].gameUrl.slice(36);j=m.child(b),e(j,a,"myGame"),k=j.child("online"),k.onDisconnect().set(!1),a.queue[0].joined+=1,a.queue[0].joined>=2&&i()}function i(){a.queue.splice(0,1)}a.$route=b,a.$location=d,a.$routeParams=c,a.renderAction=b.current.action,a.games={},a.myGame,a.queue=[],a.gameUrl=c.gameNumber||"",a.localPlayer="",a.nameEntered=!1;var j,k,l=new Firebase("https://tiqtac.firebaseio.com/queue");e(l,a,"queue",[]);var m=new Firebase("https://tiqtac.firebaseio.com/games");e(m,a,"games").then(function(){f()}),a.clearWelcome=function(){a.nameEntered=!0,""==a.myGame.playerOne.name?a.myGame.playerOne.name=a.localPlayer:(a.myGame.playerTwo.name=a.localPlayer,a.myGame.ready=!0),a.myGame.activePlayer=a.myGame.playerOne.name},a.clickReset=function(){a.myGame.reset=!0,a.nameEntered=!1,a.gameUrl="",f()},a.clickSquare2=function(b){function c(c){b.value=c,b.img="big_"+c+".png",d(c),e(i)?a.myGame.win=!0:a.myGame.turnCounter>=8?g():f()}function d(b){var c;for(c=0;c<a.myGame.ticTacToe.length;++c){var d;for(d=0;d<a.myGame.ticTacToe[c].length;++d)i+=a.myGame.ticTacToe[c][d].value==b?"1":"0"}}function e(a){var b,c;for(c=0;c<j.length;++c){b=0;var d;for(d=0;d<a.length;++d)1==a[d]&&a[d]==j[c][d]&&(b+=1);if(3==b)return!0}}function f(){var b=a.myGame.activePlayer,c=a.myGame.playerOne.name,d=a.myGame.playerTwo.name;b=b==c?d:c,a.myGame.activePlayer=b}function g(){a.myGame.tie=!0}var h,i="",j=["111000000","000111000","000000111","100100100","010010010","001001001","100010001","001010100"];a.localPlayer==a.myGame.activePlayer&&""==b.value&&(0==a.myGame.turnCounter%2?(h="x",c(h),a.myGame.turnCounter++):(h="o",c(h),a.myGame.turnCounter++))}}angular.module("newTicApp",["firebase","ngRoute"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"mainCtrl",action:null}).otherwise({redirectTo:"/"}),b.html5Mode(!0),a.when("/game/:gameNumber",{templateUrl:"views/main.html",controller:"mainCtrl",action:"joinFromUrl"})}]).directive("wait",function(){return{replace:!0,restrict:"A",link:function(a,b,c){a.$watch(c.wait,function(a){switch(a){case!0:b[0].style.display="none";break;case!1:b[0].style.display="block"}})}}});